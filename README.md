[![bigmac](https://img.shields.io/badge/BigMac-0.0.7_beta-red?logo=data:image/png;base64,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)](https://github.com/sfarrens/bigmac)
[![macos-mojave](https://img.shields.io/badge/macos-mojave-brightgreen.svg)](https://en.wikipedia.org/wiki/MacOS_Mojave)
[![macos-catalina](https://img.shields.io/badge/macos-catalina-brightgreen.svg)](https://en.wikipedia.org/wiki/MacOS_Catalina)
[![License: MIT](https://img.shields.io/github/license/sfarrens/bigmac)](https://github.com/sfarrens/bigmac/blob/master/LICENSE)

<img src="images/bigmac_logo_red.png" height=250>

# BigMac
BigMac contains a series of CMake variables that facilitate compiling C/C++ code on macOS using the default clang compiler.

## Installation

### Requirements

BigMac requires the following:

- [XCode](https://developer.apple.com/xcode/) : The default IDE for macOS. Needed for developer libraries. Should already be installed, but you may need to update it.
- Command Line Tools : These are the default macOS compilers *etc.*. You can install these by running the following in a terminal.

  ```bash
  $ xcode-select --install
  ```

- [Homebrew](https://brew.sh/) : Package manager for macOS. You can install this by running the following in a terminal.

  ```bash
  $ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
  ```

  If you already have Homebrew installed. Be sure to make sure it is up to date.

  ```bash
  $ brew update
  ```


### Homebrew

BigMac can be installed using Homebrew as follows.

```bash
$ brew tap sfarrens/sf
$ brew install bigmac
```

This is recommended as it will also install all of the required dependencies.

### From Source

BigMac can be installed manually as follows.

```bash
$ git clone https://github.com/sfarrens/bigmac.git
$ cd bigmac
$ mkdir build
$ cd build
$ cmake ..
$ make install
```

If you install BigMac manually, you will also need to manage all dependencies yourself.

## Use

To take advantage of BigMac simply include the following in your CMake project.

```cmake
find_package(BigMac REQUIRED)
```

This will provide all of the variables described below. Additionally, by providing the flag `--log-level=VERBOSE`, you can get a report of your system setup. *e.g.*

```bash
$ cmake --log-level=VERBOSE
```

This should provide something like the following.

```
-- BigMac Status
--         - macOS Version: 10.15.6
--         - Darwin Version: 19.6.0
--         - XCode Version: 11.6
--         - Homebrew Version: 2.4.12
--         - libomp Version: 10.0.1
--         - Compiler: AppleClang
--         - Compiler Version: 11.0.3.11030032
--         - Which CC: /usr/bin/clang
--         - Which CXX: /usr/bin/clang++
-- BigMac -> Setting OpenMP variables for AppleClang
--         - BigMac_CPPFLAGS -Xpreprocessor -fopenmp
--         - BigMac_OPENMP_CFLAGS -lomp
--         - OpenMP_INCLUDE_PATH /usr/local/include
--         - OpenMP_LIB_PATH /usr/local/lib
--         - OpenMP_CXX_FLAGS -Xpreprocessor -fopenmp -lomp
--         - OpenMP_CXX_LIB_NAMES omp
--         - OpenMP_CXX_LIBRARIES /usr/local/lib/libomp.dylib
```

### BigMac Variables

- `BigMac_MACOS` : macOS version
- `BigMac_DARWIN` : Darwin version
- `BigMac_XCODE` : XCode version
- `BigMac_BREW` : Homebrew version
- `BigMac_LIBOMP` : libomp version

### OpenMP Variables

- `BigMac_CPPFLAGS` : `CPPFLAGS` for external projects (*e.g.* FFTW, NFFT).
- `BigMac_OPENMP_CFLAGS` : `OPENMP_CFLAGS` for external projects (*e.g.* FFTW, NFFT).
- `OpenMP_INCLUDE_PATH` : Path to OpenMP headers.
- `OpenMP_LIB_PATH` : Path to OpenMP Libraries.
- `OpenMP_C_FLAGS` : OpenMP compiler flags for C, separated by spaces.
- `OpenMP_CXX_FLAGS` : OpenMP compiler flags for C++, separated by spaces.
- `OpenMP_C_LIB_NAMES` : List of libraries for OpenMP programs for C.
- `OpenMP_CXX_LIB_NAMES` : List of libraries for OpenMP programs for C++.
- `OpenMP_C_LIBRARIES` : A list of libraries needed to link with OpenMP code written in C.
- `OpenMP_CXX_LIBRARIES` : A list of libraries needed to link with OpenMP code written in C++.
- `OpenMP_omp_LIBRARY` : Location of the individual libraries needed for OpenMP support.
- `OpenMP_C_VERSION` : OpenMP version implemented by the C compiler.
- `OpenMP_CXX_VERSION` : OpenMP version implemented by the C++ compiler.

### External Project Flags
- `BigMac_FFTW` : Flags needed to build [FFTW](http://fftw.org/) as an external project.
- `BigMac_NFFT` : Flags needed to build [NFFT](https://github.com/NFFT/nfft) as an external project.

### Hello World Example

For the following OpenMP Hello World example.

```cpp
#include <stdio.h>
#include <omp.h>

int main(int argc, char** argv){

    #pragma omp parallel
    {
      printf("Hello from process: %d\n", omp_get_thread_num());
    }

    return 0;
}
```

You would include the following in your CMake project.

```cmake
find_package(BigMac REQUIRED)

set(CMAKE_CXX_FLAGS ${OpenMP_CXX_FLAGS})
add_executable(hello_world src/hello_world.cpp)
```

### FFTW Example

```cmake
# Download and build FFTW
ExternalProject_Add(fftw
    URL               http://www.fftw.org/fftw-3.3.8.tar.gz
    URL_HASH          8aac833c943d8e90d51b697b27d4384d
    CONFIGURE_COMMAND ./configure CC=${CMAKE_C_COMPILER} CXX=${CMAKE_CXX_COMPILER} ${BigMac_FFTW}
    BUILD_COMMAND     make
    INSTALL_COMMAND   make install
)
```
